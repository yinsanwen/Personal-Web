---
title: "Mysql Index Choose"
date: 2018-11-30T16:25:53+08:00
draft: true
---

# 索引结构
## B+树的索引结构
![b+树索引结构](/static/media/2018/11/b-tree-index.png)
图中浅蓝色方块表示一个索引节点，在innodb存储引擎中，用页来表示。在节点中深蓝色的是数据项，黄色表示指针。
假设树的高度为h，那么在树中检索一次数据，一般需要h-1次IO（根节点常驻内存）。所以检索的效率取决于树的高度。
假设当前表的总的数据量为N，每个节点能够存放的数据项个数为m。则有树的高度h=log(m+1)N。
由此可知，在N一定的情况下，m越大，树的高度越小，查询效率越高。
而一个节点的大小（数据页）是固定的(默认为16k)。所以当索引数据项占据的空间越小，每个节点中能够存放的数据项就越大，也就是m越大。
所以我们在定义索引时索引字段要尽量的小，这样可以降低树的高度。

在innodb存储引擎中，每一层的页面之间用双向链表前后关联。
![每一层用双向链表关联](/static/media/2018/11/每一层用双向链表关联.png)

## Innodb的聚簇索引和二级索引
